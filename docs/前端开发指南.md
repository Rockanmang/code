# å‰ç«¯å¼€å‘æŒ‡å—

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### 1. åŸºæœ¬è®¾ç½®

```javascript
// APIé…ç½®
const API_BASE_URL = 'http://localhost:8000';

// åˆ›å»ºAPIå®¢æˆ·ç«¯
class APIClient {
  constructor(baseURL) {
    this.baseURL = baseURL;
    this.token = localStorage.getItem('access_token');
  }

  // è®¾ç½®è®¤è¯ä»¤ç‰Œ
  setToken(token) {
    this.token = token;
    localStorage.setItem('access_token', token);
  }

  // æ¸…é™¤ä»¤ç‰Œ
  clearToken() {
    this.token = null;
    localStorage.removeItem('access_token');
    localStorage.removeItem('refresh_token');
  }

  // é€šç”¨è¯·æ±‚æ–¹æ³•
  async request(endpoint, options = {}) {
    const url = `${this.baseURL}${endpoint}`;
    const config = {
      headers: {
        'Content-Type': 'application/json',
        ...options.headers,
      },
      ...options,
    };

    // æ·»åŠ è®¤è¯å¤´
    if (this.token && !config.headers.Authorization) {
      config.headers.Authorization = `Bearer ${this.token}`;
    }

    try {
      const response = await fetch(url, config);
      
      // å¤„ç†401é”™è¯¯ï¼ˆtokenè¿‡æœŸï¼‰
      if (response.status === 401) {
        await this.handleTokenExpiry();
        return null;
      }

      const data = await response.json();
      
      if (!response.ok) {
        throw new Error(data.detail || `HTTP ${response.status}`);
      }

      return data;
    } catch (error) {
      console.error('APIè¯·æ±‚å¤±è´¥:', error);
      throw error;
    }
  }

  // å¤„ç†tokenè¿‡æœŸ
  async handleTokenExpiry() {
    const refreshToken = localStorage.getItem('refresh_token');
    
    if (refreshToken) {
      try {
        const response = await fetch(`${this.baseURL}/api/auth/refresh`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ refresh_token: refreshToken })
        });

        if (response.ok) {
          const { access_token } = await response.json();
          this.setToken(access_token);
          return true;
        }
      } catch (error) {
        console.error('Tokenåˆ·æ–°å¤±è´¥:', error);
      }
    }

    // åˆ·æ–°å¤±è´¥ï¼Œæ¸…é™¤tokenå¹¶é‡å®šå‘åˆ°ç™»å½•é¡µ
    this.clearToken();
    window.location.href = '/login';
    return false;
  }
}

// åˆ›å»ºå…¨å±€APIå®¢æˆ·ç«¯å®ä¾‹
const api = new APIClient(API_BASE_URL);
```

### 2. ç”¨æˆ·è®¤è¯

```javascript
// ç”¨æˆ·è®¤è¯ç›¸å…³API
class AuthAPI {
  // æ‰‹æœºå·æ³¨å†Œ
  static async register(userData) {
    return api.request('/api/auth/register', {
      method: 'POST',
      body: JSON.stringify(userData)
    });
  }

  // æ‰‹æœºå·ç™»å½•
  static async loginWithPhone(phone_number, password) {
    const response = await api.request('/api/auth/login', {
      method: 'POST',
      body: JSON.stringify({ phone_number, password })
    });

    if (response?.access_token) {
      api.setToken(response.access_token);
      if (response.refresh_token) {
        localStorage.setItem('refresh_token', response.refresh_token);
      }
    }

    return response;
  }

  // ä¼ ç»Ÿç”¨æˆ·åç™»å½•ï¼ˆå…¼å®¹ï¼‰
  static async loginWithUsername(username, password) {
    const formData = new FormData();
    formData.append('username', username);
    formData.append('password', password);

    const response = await fetch(`${API_BASE_URL}/login`, {
      method: 'POST',
      body: formData
    });

    const data = await response.json();
    
    if (response.ok && data.access_token) {
      api.setToken(data.access_token);
    } else {
      throw new Error(data.detail || 'ç™»å½•å¤±è´¥');
    }

    return data;
  }

  // ç™»å‡º
  static logout() {
    api.clearToken();
    window.location.href = '/login';
  }

  // è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
  static async getCurrentUser() {
    return api.request('/api/user/me');
  }
}
```

### 3. ç”¨æˆ·ç•Œé¢ç¤ºä¾‹

```jsx
// Reactç™»å½•ç»„ä»¶ç¤ºä¾‹
import React, { useState } from 'react';

const LoginForm = () => {
  const [formData, setFormData] = useState({
    phone_number: '',
    password: ''
  });
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');

  const handleLogin = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError('');

    try {
      // é¦–å…ˆå°è¯•æ‰‹æœºå·ç™»å½•
      await AuthAPI.loginWithPhone(formData.phone_number, formData.password);
      
      // ç™»å½•æˆåŠŸï¼Œé‡å®šå‘
      window.location.href = '/dashboard';
    } catch (error) {
      // å¦‚æœæ‰‹æœºå·ç™»å½•å¤±è´¥ï¼Œå¯ä»¥å°è¯•ç”¨æˆ·åç™»å½•
      try {
        await AuthAPI.loginWithUsername(formData.phone_number, formData.password);
        window.location.href = '/dashboard';
      } catch (secondError) {
        setError('ç™»å½•å¤±è´¥ï¼š' + secondError.message);
      }
    } finally {
      setLoading(false);
    }
  };

  return (
    <form onSubmit={handleLogin}>
      <div>
        <label>æ‰‹æœºå·/ç”¨æˆ·å:</label>
        <input
          type="text"
          value={formData.phone_number}
          onChange={(e) => setFormData({...formData, phone_number: e.target.value})}
          placeholder="è¯·è¾“å…¥æ‰‹æœºå·æˆ–ç”¨æˆ·å"
          required
        />
      </div>
      
      <div>
        <label>å¯†ç :</label>
        <input
          type="password"
          value={formData.password}
          onChange={(e) => setFormData({...formData, password: e.target.value})}
          required
        />
      </div>

      {error && <div style={{color: 'red'}}>{error}</div>}
      
      <button type="submit" disabled={loading}>
        {loading ? 'ç™»å½•ä¸­...' : 'ç™»å½•'}
      </button>
    </form>
  );
};
```

## ğŸ“‹ ç ”ç©¶ç»„ç®¡ç†

```javascript
// ç ”ç©¶ç»„ç›¸å…³API
class GroupAPI {
  // è·å–ç”¨æˆ·ç ”ç©¶ç»„
  static async getUserGroups() {
    return api.request('/user/groups');
  }

  // åˆ›å»ºç ”ç©¶ç»„
  static async createGroup(groupData) {
    const params = new URLSearchParams(groupData);
    return api.request(`/groups/create?${params}`, {
      method: 'POST'
    });
  }

  // åŠ å…¥ç ”ç©¶ç»„
  static async joinGroup(group_id, invitation_code) {
    const params = new URLSearchParams({ group_id, invitation_code });
    return api.request(`/groups/join?${params}`, {
      method: 'POST'
    });
  }
}

// Reactç ”ç©¶ç»„ç»„ä»¶ç¤ºä¾‹
const GroupManager = () => {
  const [groups, setGroups] = useState([]);
  const [showCreateForm, setShowCreateForm] = useState(false);

  useEffect(() => {
    loadUserGroups();
  }, []);

  const loadUserGroups = async () => {
    try {
      const response = await GroupAPI.getUserGroups();
      setGroups(response.groups || []);
    } catch (error) {
      console.error('åŠ è½½ç ”ç©¶ç»„å¤±è´¥:', error);
    }
  };

  const handleCreateGroup = async (groupData) => {
    try {
      const response = await GroupAPI.createGroup(groupData);
      alert('ç ”ç©¶ç»„åˆ›å»ºæˆåŠŸï¼é‚€è¯·ç ï¼š' + response.invitation_code);
      loadUserGroups(); // é‡æ–°åŠ è½½
      setShowCreateForm(false);
    } catch (error) {
      alert('åˆ›å»ºå¤±è´¥ï¼š' + error.message);
    }
  };

  return (
    <div>
      <h2>æˆ‘çš„ç ”ç©¶ç»„</h2>
      
      <button onClick={() => setShowCreateForm(true)}>
        åˆ›å»ºç ”ç©¶ç»„
      </button>

      <div>
        {groups.map(group => (
          <div key={group.id} style={{border: '1px solid #ccc', margin: '10px', padding: '10px'}}>
            <h3>{group.name}</h3>
            <p>æœºæ„ï¼š{group.institution}</p>
            <p>é¢†åŸŸï¼š{group.research_area}</p>
            <p>é‚€è¯·ç ï¼š{group.invitation_code}</p>
          </div>
        ))}
      </div>

      {showCreateForm && (
        <CreateGroupForm 
          onSubmit={handleCreateGroup}
          onCancel={() => setShowCreateForm(false)}
        />
      )}
    </div>
  );
};
```

## ğŸ“š æ–‡çŒ®ç®¡ç†

```javascript
// æ–‡çŒ®ç›¸å…³API
class LiteratureAPI {
  // è·å–ç ”ç©¶ç»„æ–‡çŒ®åˆ—è¡¨
  static async getGroupLiterature(groupId) {
    return api.request(`/literature/public/${groupId}`);
  }

  // è·å–æ–‡çŒ®è¯¦æƒ…
  static async getLiteratureDetail(literatureId) {
    return api.request(`/literature/detail/${literatureId}`);
  }

  // ä¸Šä¼ æ–‡çŒ®
  static async uploadLiterature(file, groupId, title = '') {
    const formData = new FormData();
    formData.append('file', file);
    formData.append('group_id', groupId);
    if (title) formData.append('title', title);

    return api.request('/literature/upload', {
      method: 'POST',
      headers: {
        // ä¸è®¾ç½®Content-Typeï¼Œè®©æµè§ˆå™¨è‡ªåŠ¨è®¾ç½®
        'Authorization': `Bearer ${api.token}`
      },
      body: formData
    });
  }

  // è·å–æ–‡çŒ®æ–‡ä»¶URL
  static getFileURL(literatureId) {
    return `${API_BASE_URL}/literature/view/file/${literatureId}`;
  }
}

// Reactæ–‡çŒ®ä¸Šä¼ ç»„ä»¶
const LiteratureUpload = ({ groupId, onUploadSuccess }) => {
  const [uploading, setUploading] = useState(false);
  const [selectedFile, setSelectedFile] = useState(null);
  const [title, setTitle] = useState('');

  const handleFileChange = (e) => {
    const file = e.target.files[0];
    if (file) {
      // æ£€æŸ¥æ–‡ä»¶ç±»å‹
      const allowedTypes = ['application/pdf', 'application/msword', 
        'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
      
      if (!allowedTypes.includes(file.type)) {
        alert('åªæ”¯æŒPDFå’ŒWordæ–‡æ¡£');
        return;
      }

      // æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆ50MBï¼‰
      if (file.size > 50 * 1024 * 1024) {
        alert('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡50MB');
        return;
      }

      setSelectedFile(file);
      // å¦‚æœæ²¡æœ‰è®¾ç½®æ ‡é¢˜ï¼Œä½¿ç”¨æ–‡ä»¶å
      if (!title) {
        setTitle(file.name.split('.')[0]);
      }
    }
  };

  const handleUpload = async () => {
    if (!selectedFile) {
      alert('è¯·é€‰æ‹©æ–‡ä»¶');
      return;
    }

    setUploading(true);
    try {
      const response = await LiteratureAPI.uploadLiterature(
        selectedFile, 
        groupId, 
        title
      );
      
      alert('ä¸Šä¼ æˆåŠŸï¼š' + response.title);
      onUploadSuccess && onUploadSuccess(response);
      
      // é‡ç½®è¡¨å•
      setSelectedFile(null);
      setTitle('');
    } catch (error) {
      alert('ä¸Šä¼ å¤±è´¥ï¼š' + error.message);
    } finally {
      setUploading(false);
    }
  };

  return (
    <div>
      <h3>ä¸Šä¼ æ–‡çŒ®</h3>
      
      <div>
        <label>é€‰æ‹©æ–‡ä»¶:</label>
        <input
          type="file"
          accept=".pdf,.doc,.docx"
          onChange={handleFileChange}
          disabled={uploading}
        />
      </div>

      {selectedFile && (
        <div>
          <label>æ ‡é¢˜:</label>
          <input
            type="text"
            value={title}
            onChange={(e) => setTitle(e.target.value)}
            placeholder="æ–‡çŒ®æ ‡é¢˜"
          />
        </div>
      )}

      <button 
        onClick={handleUpload}
        disabled={!selectedFile || uploading}
      >
        {uploading ? 'ä¸Šä¼ ä¸­...' : 'ä¸Šä¼ '}
      </button>
    </div>
  );
};

// æ–‡çŒ®åˆ—è¡¨ç»„ä»¶
const LiteratureList = ({ groupId }) => {
  const [literature, setLiterature] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadLiterature();
  }, [groupId]);

  const loadLiterature = async () => {
    try {
      const response = await LiteratureAPI.getGroupLiterature(groupId);
      setLiterature(response.literature || []);
    } catch (error) {
      console.error('åŠ è½½æ–‡çŒ®å¤±è´¥:', error);
    } finally {
      setLoading(false);
    }
  };

  const handleFileView = (literatureId) => {
    // åœ¨æ–°çª—å£æ‰“å¼€æ–‡ä»¶
    const fileURL = LiteratureAPI.getFileURL(literatureId);
    window.open(fileURL, '_blank');
  };

  if (loading) return <div>åŠ è½½ä¸­...</div>;

  return (
    <div>
      <h3>æ–‡çŒ®åˆ—è¡¨</h3>
      
      {literature.length === 0 ? (
        <p>æš‚æ— æ–‡çŒ®</p>
      ) : (
        <div>
          {literature.map(lit => (
            <div key={lit.id} style={{border: '1px solid #ddd', margin: '10px', padding: '10px'}}>
              <h4>{lit.title}</h4>
              <p>æ–‡ä»¶å: {lit.filename}</p>
              <p>å¤§å°: {(lit.file_size / 1024 / 1024).toFixed(2)} MB</p>
              <p>ä¸Šä¼ æ—¶é—´: {new Date(lit.upload_time).toLocaleString()}</p>
              <p>ä¸Šä¼ è€…: {lit.uploaded_by}</p>
              
              <button onClick={() => handleFileView(lit.id)}>
                æŸ¥çœ‹æ–‡ä»¶
              </button>
            </div>
          ))}
        </div>
      )}
    </div>
  );
};
```

## ğŸ¤– AIåŠ©æ‰‹

```javascript
// AIç›¸å…³API
class AIAPI {
  // è·å–é¢„è®¾é—®é¢˜
  static async getPresetQuestions(literatureId) {
    return api.request(`/ai/preset-questions/${literatureId}`);
  }

  // AIé—®ç­”
  static async askQuestion(question, literatureId, options = {}) {
    const requestData = {
      question,
      literature_id: literatureId,
      max_sources: options.maxSources || 5,
      include_history: options.includeHistory || false,
      ...options
    };

    return api.request('/ai/ask', {
      method: 'POST',
      body: JSON.stringify(requestData)
    });
  }
}

// React AIèŠå¤©ç»„ä»¶
const AIChat = ({ literatureId }) => {
  const [messages, setMessages] = useState([]);
  const [inputQuestion, setInputQuestion] = useState('');
  const [loading, setLoading] = useState(false);
  const [presetQuestions, setPresetQuestions] = useState([]);

  useEffect(() => {
    loadPresetQuestions();
  }, [literatureId]);

  const loadPresetQuestions = async () => {
    try {
      const response = await AIAPI.getPresetQuestions(literatureId);
      setPresetQuestions(response.questions || []);
    } catch (error) {
      console.error('åŠ è½½é¢„è®¾é—®é¢˜å¤±è´¥:', error);
    }
  };

  const askQuestion = async (question) => {
    if (!question.trim()) return;

    // æ·»åŠ ç”¨æˆ·é—®é¢˜åˆ°æ¶ˆæ¯åˆ—è¡¨
    const userMessage = { type: 'user', content: question, timestamp: new Date() };
    setMessages(prev => [...prev, userMessage]);
    setInputQuestion('');
    setLoading(true);

    try {
      const response = await AIAPI.askQuestion(question, literatureId);
      
      // æ·»åŠ AIå›ç­”åˆ°æ¶ˆæ¯åˆ—è¡¨
      const aiMessage = {
        type: 'ai',
        content: response.answer,
        sources: response.sources,
        confidence: response.confidence,
        timestamp: new Date()
      };
      
      setMessages(prev => [...prev, aiMessage]);
    } catch (error) {
      // æ·»åŠ é”™è¯¯æ¶ˆæ¯
      const errorMessage = {
        type: 'error',
        content: 'æŠ±æ­‰ï¼ŒAIæœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼š' + error.message,
        timestamp: new Date()
      };
      setMessages(prev => [...prev, errorMessage]);
    } finally {
      setLoading(false);
    }
  };

  const handlePresetQuestion = (question) => {
    askQuestion(question);
  };

  return (
    <div style={{maxWidth: '600px', margin: '0 auto'}}>
      <h3>AIåŠ©æ‰‹</h3>
      
      {/* é¢„è®¾é—®é¢˜ */}
      {presetQuestions.length > 0 && (
        <div style={{marginBottom: '20px'}}>
          <h4>é¢„è®¾é—®é¢˜:</h4>
          {presetQuestions.map((question, index) => (
            <button
              key={index}
              onClick={() => handlePresetQuestion(question)}
              style={{
                display: 'block',
                width: '100%',
                margin: '5px 0',
                padding: '10px',
                textAlign: 'left',
                border: '1px solid #ddd',
                background: '#f9f9f9',
                cursor: 'pointer'
              }}
            >
              {question}
            </button>
          ))}
        </div>
      )}

      {/* èŠå¤©æ¶ˆæ¯ */}
      <div style={{
        height: '400px',
        overflowY: 'scroll',
        border: '1px solid #ddd',
        padding: '10px',
        marginBottom: '10px'
      }}>
        {messages.map((message, index) => (
          <div key={index} style={{
            marginBottom: '15px',
            padding: '10px',
            borderRadius: '8px',
            backgroundColor: message.type === 'user' ? '#e3f2fd' : 
                           message.type === 'error' ? '#ffebee' : '#f5f5f5'
          }}>
            <div style={{fontWeight: 'bold', marginBottom: '5px'}}>
              {message.type === 'user' ? 'æ‚¨' : 
               message.type === 'error' ? 'é”™è¯¯' : 'AIåŠ©æ‰‹'}
            </div>
            <div>{message.content}</div>
            
            {/* æ˜¾ç¤ºAIå›ç­”çš„æ¥æº */}
            {message.sources && message.sources.length > 0 && (
              <div style={{marginTop: '10px', fontSize: '0.9em', color: '#666'}}>
                <strong>å‚è€ƒæ¥æº:</strong>
                {message.sources.map((source, idx) => (
                  <div key={idx} style={{marginLeft: '10px', marginTop: '5px'}}>
                    â€¢ {source.content.substring(0, 100)}...
                    {source.page && ` (ç¬¬${source.page}é¡µ)`}
                  </div>
                ))}
              </div>
            )}
            
            <div style={{fontSize: '0.8em', color: '#999', marginTop: '5px'}}>
              {message.timestamp.toLocaleTimeString()}
            </div>
          </div>
        ))}
        
        {loading && (
          <div style={{textAlign: 'center', color: '#666'}}>
            AIæ­£åœ¨æ€è€ƒä¸­...
          </div>
        )}
      </div>

      {/* è¾“å…¥æ¡† */}
      <div style={{display: 'flex'}}>
        <input
          type="text"
          value={inputQuestion}
          onChange={(e) => setInputQuestion(e.target.value)}
          placeholder="è¾“å…¥æ‚¨çš„é—®é¢˜..."
          style={{flex: 1, padding: '10px', marginRight: '10px'}}
          onKeyPress={(e) => e.key === 'Enter' && askQuestion(inputQuestion)}
          disabled={loading}
        />
        <button
          onClick={() => askQuestion(inputQuestion)}
          disabled={loading || !inputQuestion.trim()}
          style={{padding: '10px 20px'}}
        >
          å‘é€
        </button>
      </div>
    </div>
  );
};
```

## ğŸ”§ æœ€ä½³å®è·µ

### 1. é”™è¯¯å¤„ç†ç­–ç•¥

```javascript
// å…¨å±€é”™è¯¯å¤„ç†å™¨
class ErrorHandler {
  static handle(error, context = '') {
    console.error(`[${context}] é”™è¯¯:`, error);
    
    // æ ¹æ®é”™è¯¯ç±»å‹è¿›è¡Œä¸åŒå¤„ç†
    if (error.message.includes('401')) {
      // æœªè®¤è¯ï¼Œé‡å®šå‘åˆ°ç™»å½•é¡µ
      AuthAPI.logout();
    } else if (error.message.includes('403')) {
      // æƒé™ä¸è¶³
      alert('æƒé™ä¸è¶³ï¼Œè¯·è”ç³»ç®¡ç†å‘˜');
    } else if (error.message.includes('413')) {
      // æ–‡ä»¶è¿‡å¤§
      alert('æ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶(50MB)');
    } else {
      // å…¶ä»–é”™è¯¯
      alert('æ“ä½œå¤±è´¥ï¼š' + error.message);
    }
  }
}

// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
try {
  await SomeAPI.someMethod();
} catch (error) {
  ErrorHandler.handle(error, 'æ–‡çŒ®ä¸Šä¼ ');
}
```

### 2. åŠ è½½çŠ¶æ€ç®¡ç†

```javascript
// è‡ªå®šä¹‰Hookç®¡ç†åŠ è½½çŠ¶æ€
const useAsyncOperation = () => {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);

  const execute = async (asyncFn) => {
    setLoading(true);
    setError(null);
    
    try {
      const result = await asyncFn();
      return result;
    } catch (err) {
      setError(err);
      throw err;
    } finally {
      setLoading(false);
    }
  };

  return { loading, error, execute };
};

// ä½¿ç”¨ç¤ºä¾‹
const MyComponent = () => {
  const { loading, error, execute } = useAsyncOperation();

  const handleUpload = async () => {
    await execute(() => LiteratureAPI.uploadLiterature(file, groupId));
  };

  return (
    <div>
      {loading && <div>åŠ è½½ä¸­...</div>}
      {error && <div>é”™è¯¯: {error.message}</div>}
      <button onClick={handleUpload} disabled={loading}>
        ä¸Šä¼ 
      </button>
    </div>
  );
};
```

### 3. æ•°æ®ç¼“å­˜ç­–ç•¥

```javascript
// ç®€å•çš„å†…å­˜ç¼“å­˜
class Cache {
  static data = new Map();
  static timeouts = new Map();

  static set(key, value, ttl = 300000) { // é»˜è®¤5åˆ†é’Ÿ
    this.data.set(key, value);
    
    // æ¸…é™¤ä¹‹å‰çš„è¶…æ—¶
    if (this.timeouts.has(key)) {
      clearTimeout(this.timeouts.get(key));
    }
    
    // è®¾ç½®æ–°çš„è¶…æ—¶
    const timeout = setTimeout(() => {
      this.data.delete(key);
      this.timeouts.delete(key);
    }, ttl);
    
    this.timeouts.set(key, timeout);
  }

  static get(key) {
    return this.data.get(key);
  }

  static has(key) {
    return this.data.has(key);
  }

  static clear() {
    this.data.clear();
    this.timeouts.forEach(timeout => clearTimeout(timeout));
    this.timeouts.clear();
  }
}

// å¸¦ç¼“å­˜çš„APIè°ƒç”¨
class CachedAPI {
  static async getGroupLiterature(groupId) {
    const cacheKey = `literature_${groupId}`;
    
    if (Cache.has(cacheKey)) {
      return Cache.get(cacheKey);
    }
    
    const data = await LiteratureAPI.getGroupLiterature(groupId);
    Cache.set(cacheKey, data);
    return data;
  }

  // æ¸…é™¤ç›¸å…³ç¼“å­˜
  static invalidateGroupCache(groupId) {
    Cache.data.delete(`literature_${groupId}`);
  }
}
```

## ğŸ†• æ–°å¢åŠŸèƒ½ç¤ºä¾‹

### 1. æ–‡çŒ®é«˜çº§ç®¡ç†

```javascript
// æ–‡çŒ®é«˜çº§ç®¡ç†API
class LiteratureAdvancedAPI {
  // è½¯åˆ é™¤æ–‡çŒ®
  static async deleteLiterature(literatureId, reason = '') {
    const params = new URLSearchParams();
    if (reason) params.append('reason', reason);
    
    return api.request(`/literature/${literatureId}?${params}`, {
      method: 'DELETE'
    });
  }

  // æ¢å¤å·²åˆ é™¤æ–‡çŒ®
  static async restoreLiterature(literatureId) {
    return api.request(`/literature/${literatureId}/restore`, {
      method: 'POST'
    });
  }

  // è·å–å·²åˆ é™¤æ–‡çŒ®åˆ—è¡¨
  static async getDeletedLiterature(groupId) {
    return api.request(`/literature/deleted/${groupId}`);
  }

  // è·å–æ–‡çŒ®ç»Ÿè®¡ä¿¡æ¯
  static async getLiteratureStats(groupId) {
    return api.request(`/literature/stats/${groupId}`);
  }
}

// Reactæ–‡çŒ®ç®¡ç†ç»„ä»¶ç¤ºä¾‹
const LiteratureManager = ({ groupId }) => {
  const [literature, setLiterature] = useState([]);
  const [deletedLiterature, setDeletedLiterature] = useState([]);
  const [stats, setStats] = useState(null);
  const [showDeleted, setShowDeleted] = useState(false);

  // åˆ é™¤æ–‡çŒ®
  const handleDelete = async (literatureId, reason) => {
    try {
      await LiteratureAdvancedAPI.deleteLiterature(literatureId, reason);
      alert('æ–‡çŒ®å·²åˆ é™¤');
      loadLiterature();
      loadDeletedLiterature();
    } catch (error) {
      alert('åˆ é™¤å¤±è´¥ï¼š' + error.message);
    }
  };

  // æ¢å¤æ–‡çŒ®
  const handleRestore = async (literatureId) => {
    try {
      await LiteratureAdvancedAPI.restoreLiterature(literatureId);
      alert('æ–‡çŒ®å·²æ¢å¤');
      loadLiterature();
      loadDeletedLiterature();
    } catch (error) {
      alert('æ¢å¤å¤±è´¥ï¼š' + error.message);
    }
  };

  const loadDeletedLiterature = async () => {
    try {
      const response = await LiteratureAdvancedAPI.getDeletedLiterature(groupId);
      setDeletedLiterature(response.deleted_literature || []);
    } catch (error) {
      console.error('åŠ è½½å·²åˆ é™¤æ–‡çŒ®å¤±è´¥:', error);
    }
  };

  const loadStats = async () => {
    try {
      const response = await LiteratureAdvancedAPI.getLiteratureStats(groupId);
      setStats(response.statistics);
    } catch (error) {
      console.error('åŠ è½½ç»Ÿè®¡ä¿¡æ¯å¤±è´¥:', error);
    }
  };

  return (
    <div>
      {/* ç»Ÿè®¡ä¿¡æ¯ */}
      {stats && (
        <div style={{background: '#f5f5f5', padding: '10px', margin: '10px 0'}}>
          <h4>æ–‡çŒ®ç»Ÿè®¡</h4>
          <p>æ´»è·ƒæ–‡çŒ®: {stats.active_count}</p>
          <p>å·²åˆ é™¤: {stats.deleted_count}</p>
          <p>æ€»å¤§å°: {(stats.total_size / 1024 / 1024).toFixed(2)} MB</p>
        </div>
      )}

      {/* åˆ‡æ¢æ˜¾ç¤º */}
      <div>
        <button onClick={() => setShowDeleted(false)}>æ´»è·ƒæ–‡çŒ®</button>
        <button onClick={() => setShowDeleted(true)}>å›æ”¶ç«™</button>
      </div>

      {/* æ–‡çŒ®åˆ—è¡¨ */}
      {!showDeleted ? (
        <div>
          {literature.map(lit => (
            <div key={lit.id}>
              <h4>{lit.title}</h4>
              <button onClick={() => handleDelete(lit.id, 'ç”¨æˆ·åˆ é™¤')}>
                åˆ é™¤
              </button>
            </div>
          ))}
        </div>
      ) : (
        <div>
          {deletedLiterature.map(lit => (
            <div key={lit.id}>
              <h4>{lit.title}</h4>
              <p>åˆ é™¤æ—¶é—´: {new Date(lit.deleted_at).toLocaleString()}</p>
              <p>åˆ é™¤åŸå› : {lit.delete_reason}</p>
              <button onClick={() => handleRestore(lit.id)}>
                æ¢å¤
              </button>
            </div>
          ))}
        </div>
      )}
    </div>
  );
};
```

### 2. å¯¹è¯ç®¡ç†

```javascript
// å¯¹è¯ç®¡ç†API
class ConversationAPI {
  // è·å–ç”¨æˆ·ä¼šè¯åˆ—è¡¨
  static async getUserSessions(literatureId = null, limit = 20, offset = 0) {
    const params = new URLSearchParams({ limit, offset });
    if (literatureId) params.append('literature_id', literatureId);
    
    return api.request(`/ai/sessions?${params}`);
  }

  // è·å–å¯¹è¯å†å²
  static async getConversationHistory(sessionId, includeFullContent = true, limit = 50) {
    const params = new URLSearchParams({
      include_full_content: includeFullContent,
      limit
    });
    
    return api.request(`/ai/conversation/${sessionId}?${params}`);
  }

  // åˆ é™¤å¯¹è¯ä¼šè¯
  static async deleteSession(sessionId) {
    return api.request(`/ai/conversation/${sessionId}`, {
      method: 'DELETE'
    });
  }

  // æäº¤åé¦ˆ
  static async submitFeedback(turnId, rating, feedback = '') {
    return api.request('/ai/feedback', {
      method: 'POST',
      body: JSON.stringify({
        turn_id: turnId,
        rating,
        feedback
      })
    });
  }
}

// Reactå¯¹è¯å†å²ç»„ä»¶
const ConversationHistory = () => {
  const [sessions, setSessions] = useState([]);
  const [selectedSession, setSelectedSession] = useState(null);
  const [conversationTurns, setConversationTurns] = useState([]);

  useEffect(() => {
    loadSessions();
  }, []);

  const loadSessions = async () => {
    try {
      const response = await ConversationAPI.getUserSessions();
      setSessions(response.sessions || []);
    } catch (error) {
      console.error('åŠ è½½ä¼šè¯åˆ—è¡¨å¤±è´¥:', error);
    }
  };

  const loadConversation = async (sessionId) => {
    try {
      const response = await ConversationAPI.getConversationHistory(sessionId);
      setConversationTurns(response.conversation_turns || []);
      setSelectedSession(sessionId);
    } catch (error) {
      console.error('åŠ è½½å¯¹è¯å†å²å¤±è´¥:', error);
    }
  };

  const handleDeleteSession = async (sessionId) => {
    if (window.confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¯¹è¯ä¼šè¯å—ï¼Ÿ')) {
      try {
        await ConversationAPI.deleteSession(sessionId);
        loadSessions();
        if (selectedSession === sessionId) {
          setSelectedSession(null);
          setConversationTurns([]);
        }
      } catch (error) {
        alert('åˆ é™¤å¤±è´¥ï¼š' + error.message);
      }
    }
  };

  const handleFeedback = async (turnId, rating) => {
    try {
      await ConversationAPI.submitFeedback(turnId, rating);
      alert('åé¦ˆæäº¤æˆåŠŸ');
    } catch (error) {
      alert('åé¦ˆæäº¤å¤±è´¥ï¼š' + error.message);
    }
  };

  return (
    <div style={{display: 'flex', height: '600px'}}>
      {/* ä¼šè¯åˆ—è¡¨ */}
      <div style={{width: '300px', borderRight: '1px solid #ddd', padding: '10px'}}>
        <h3>å¯¹è¯å†å²</h3>
        {sessions.map(session => (
          <div 
            key={session.session_id}
            style={{
              border: '1px solid #eee',
              margin: '5px 0',
              padding: '10px',
              cursor: 'pointer',
              backgroundColor: selectedSession === session.session_id ? '#e3f2fd' : 'white'
            }}
            onClick={() => loadConversation(session.session_id)}
          >
            <div style={{fontWeight: 'bold'}}>{session.literature_title}</div>
            <div style={{fontSize: '0.9em', color: '#666'}}>
              {new Date(session.last_activity).toLocaleString()}
            </div>
            <div style={{fontSize: '0.8em', color: '#999'}}>
              {session.turn_count} è½®å¯¹è¯
            </div>
            <button 
              onClick={(e) => {
                e.stopPropagation();
                handleDeleteSession(session.session_id);
              }}
              style={{marginTop: '5px', fontSize: '0.8em'}}
            >
              åˆ é™¤
            </button>
          </div>
        ))}
      </div>

      {/* å¯¹è¯è¯¦æƒ… */}
      <div style={{flex: 1, padding: '10px'}}>
        {selectedSession ? (
          <div>
            <h3>å¯¹è¯è¯¦æƒ…</h3>
            {conversationTurns.map(turn => (
              <div key={turn.turn_id} style={{marginBottom: '20px'}}>
                <div style={{
                  background: '#e3f2fd',
                  padding: '10px',
                  borderRadius: '8px',
                  marginBottom: '5px'
                }}>
                  <strong>é—®é¢˜:</strong> {turn.question}
                </div>
                <div style={{
                  background: '#f5f5f5',
                  padding: '10px',
                  borderRadius: '8px',
                  marginBottom: '10px'
                }}>
                  <strong>å›ç­”:</strong> {turn.answer}
                  <div style={{fontSize: '0.8em', color: '#666', marginTop: '5px'}}>
                    ç½®ä¿¡åº¦: {(turn.confidence * 100).toFixed(1)}% | 
                    å¤„ç†æ—¶é—´: {turn.processing_time}s
                  </div>
                </div>
                <div>
                  <span>è¯„åˆ†: </span>
                  {[1,2,3,4,5].map(rating => (
                    <button
                      key={rating}
                      onClick={() => handleFeedback(turn.turn_id, rating)}
                      style={{
                        background: turn.user_rating === rating ? '#2196F3' : '#eee',
                        color: turn.user_rating === rating ? 'white' : 'black',
                        border: 'none',
                        padding: '2px 6px',
                        margin: '0 2px',
                        borderRadius: '3px',
                        cursor: 'pointer'
                      }}
                    >
                      {rating}
                    </button>
                  ))}
                </div>
              </div>
            ))}
          </div>
        ) : (
          <div>è¯·é€‰æ‹©ä¸€ä¸ªå¯¹è¯ä¼šè¯æŸ¥çœ‹è¯¦æƒ…</div>
        )}
      </div>
    </div>
  );
};
```

### 3. ç¼“å­˜ç®¡ç†

```javascript
// ç¼“å­˜ç®¡ç†API
class CacheAPI {
  // è·å–ç¼“å­˜ç»Ÿè®¡
  static async getCacheStats() {
    return api.request('/admin/cache/stats', {
      headers: {} // ä¸éœ€è¦è®¤è¯
    });
  }

  // ç¼“å­˜å¥åº·æ£€æŸ¥
  static async getCacheHealth() {
    return api.request('/admin/cache/health', {
      headers: {}
    });
  }

  // æ¸…ç†ç¼“å­˜
  static async clearCache(cacheType = 'all') {
    const params = new URLSearchParams({ cache_type: cacheType });
    return api.request(`/admin/cache/clear?${params}`, {
      method: 'POST',
      headers: {}
    });
  }

  // é¢„çƒ­ç¼“å­˜
  static async warmCache(literatureIds, cacheTypes) {
    return api.request('/admin/cache/warm', {
      method: 'POST',
      headers: {},
      body: JSON.stringify({
        literature_ids: literatureIds,
        cache_types: cacheTypes
      })
    });
  }

  // æ€§èƒ½æµ‹è¯•
  static async benchmarkCache() {
    return api.request('/admin/cache/benchmark', {
      headers: {}
    });
  }
}

// Reactç¼“å­˜ç®¡ç†ç»„ä»¶
const CacheManager = () => {
  const [stats, setStats] = useState(null);
  const [health, setHealth] = useState(null);
  const [loading, setLoading] = useState(false);

  useEffect(() => {
    loadCacheInfo();
  }, []);

  const loadCacheInfo = async () => {
    try {
      const [statsResponse, healthResponse] = await Promise.all([
        CacheAPI.getCacheStats(),
        CacheAPI.getCacheHealth()
      ]);
      setStats(statsResponse.data);
      setHealth(healthResponse.data);
    } catch (error) {
      console.error('åŠ è½½ç¼“å­˜ä¿¡æ¯å¤±è´¥:', error);
    }
  };

  const handleClearCache = async (cacheType) => {
    setLoading(true);
    try {
      await CacheAPI.clearCache(cacheType);
      alert(`${cacheType}ç¼“å­˜æ¸…ç†å®Œæˆ`);
      loadCacheInfo();
    } catch (error) {
      alert('ç¼“å­˜æ¸…ç†å¤±è´¥ï¼š' + error.message);
    } finally {
      setLoading(false);
    }
  };

  const handleWarmCache = async () => {
    setLoading(true);
    try {
      // é¢„çƒ­å½“å‰å¯è§çš„æ–‡çŒ®
      await CacheAPI.warmCache(['current-literature-id'], ['embedding', 'chunk']);
      alert('ç¼“å­˜é¢„çƒ­å®Œæˆ');
      loadCacheInfo();
    } catch (error) {
      alert('ç¼“å­˜é¢„çƒ­å¤±è´¥ï¼š' + error.message);
    } finally {
      setLoading(false);
    }
  };

  const handleBenchmark = async () => {
    setLoading(true);
    try {
      const result = await CacheAPI.benchmarkCache();
      alert('æ€§èƒ½æµ‹è¯•å®Œæˆï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°');
      console.log('ç¼“å­˜æ€§èƒ½æµ‹è¯•ç»“æœ:', result);
    } catch (error) {
      alert('æ€§èƒ½æµ‹è¯•å¤±è´¥ï¼š' + error.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div>
      <h2>ç¼“å­˜ç®¡ç†</h2>
      
      {/* å¥åº·çŠ¶æ€ */}
      {health && (
        <div style={{background: '#f5f5f5', padding: '15px', margin: '10px 0'}}>
          <h3>ç¼“å­˜å¥åº·çŠ¶æ€</h3>
          <p>æ€»ä½“çŠ¶æ€: <span style={{
            color: health.overall_status === 'healthy' ? 'green' : 'orange'
          }}>
            {health.overall_status}
          </span></p>
          <p>å†…å­˜ä½¿ç”¨: {health.memory_usage?.total}</p>
          <p>ä½¿ç”¨ç‡: {health.memory_usage?.usage_percentage}%</p>
        </div>
      )}

      {/* ç¼“å­˜ç»Ÿè®¡ */}
      {stats && (
        <div style={{background: '#fff', border: '1px solid #ddd', padding: '15px', margin: '10px 0'}}>
          <h3>ç¼“å­˜ç»Ÿè®¡</h3>
          {Object.entries(stats).map(([cacheType, info]) => (
            <div key={cacheType} style={{marginBottom: '10px'}}>
              <h4>{cacheType.replace('_', ' ').toUpperCase()}</h4>
              <p>å¤§å°: {info.size} æ¡ç›®</p>
              <p>å‘½ä¸­ç‡: {(info.hit_rate * 100).toFixed(1)}%</p>
              <p>å†…å­˜ä½¿ç”¨: {info.memory_usage}</p>
              <button 
                onClick={() => handleClearCache(cacheType.replace('_cache', ''))}
                disabled={loading}
                style={{marginRight: '10px'}}
              >
                æ¸…ç†
              </button>
            </div>
          ))}
        </div>
      )}

      {/* æ“ä½œæŒ‰é’® */}
      <div style={{margin: '20px 0'}}>
        <button 
          onClick={() => handleClearCache('all')}
          disabled={loading}
          style={{marginRight: '10px', backgroundColor: '#f44336', color: 'white'}}
        >
          æ¸…ç†æ‰€æœ‰ç¼“å­˜
        </button>
        <button 
          onClick={handleWarmCache}
          disabled={loading}
          style={{marginRight: '10px', backgroundColor: '#4CAF50', color: 'white'}}
        >
          é¢„çƒ­ç¼“å­˜
        </button>
        <button 
          onClick={handleBenchmark}
          disabled={loading}
          style={{marginRight: '10px', backgroundColor: '#2196F3', color: 'white'}}
        >
          æ€§èƒ½æµ‹è¯•
        </button>
        <button 
          onClick={loadCacheInfo}
          disabled={loading}
        >
          åˆ·æ–°ä¿¡æ¯
        </button>
      </div>

      {loading && <div>æ“ä½œä¸­...</div>}
    </div>
  );
};
```

### 4. ç®¡ç†å‘˜åŠŸèƒ½

```javascript
// ç®¡ç†å‘˜åŠŸèƒ½API
class AdminAPI {
  // è·å–å­˜å‚¨ç»Ÿè®¡
  static async getStorageStats() {
    return api.request('/admin/storage/stats');
  }

  // æ¸…ç†å­˜å‚¨
  static async cleanupStorage() {
    return api.request('/admin/storage/cleanup', {
      method: 'POST'
    });
  }

  // è·å–AIæœåŠ¡ç»Ÿè®¡
  static async getAIStats() {
    return api.request('/ai/stats');
  }
}

// Reactç®¡ç†å‘˜æ§åˆ¶å°ç»„ä»¶
const AdminDashboard = () => {
  const [storageStats, setStorageStats] = useState(null);
  const [aiStats, setAIStats] = useState(null);
  const [loading, setLoading] = useState(false);

  useEffect(() => {
    loadAllStats();
  }, []);

  const loadAllStats = async () => {
    try {
      const [storage, ai] = await Promise.all([
        AdminAPI.getStorageStats(),
        AdminAPI.getAIStats()
      ]);
      setStorageStats(storage);
      setAIStats(ai);
    } catch (error) {
      console.error('åŠ è½½ç»Ÿè®¡ä¿¡æ¯å¤±è´¥:', error);
    }
  };

  const handleStorageCleanup = async () => {
    if (window.confirm('ç¡®å®šè¦æ¸…ç†å­˜å‚¨ç©ºé—´å—ï¼Ÿè¿™å°†åˆ é™¤ç©ºç›®å½•ã€‚')) {
      setLoading(true);
      try {
        const result = await AdminAPI.cleanupStorage();
        alert(`æ¸…ç†å®Œæˆï¼Œåˆ é™¤äº† ${result.count} ä¸ªç©ºç›®å½•`);
        loadAllStats();
      } catch (error) {
        alert('å­˜å‚¨æ¸…ç†å¤±è´¥ï¼š' + error.message);
      } finally {
        setLoading(false);
      }
    }
  };

  return (
    <div>
      <h2>ç®¡ç†å‘˜æ§åˆ¶å°</h2>
      
      {/* å­˜å‚¨ç»Ÿè®¡ */}
      {storageStats && (
        <div style={{background: '#f5f5f5', padding: '15px', margin: '10px 0'}}>
          <h3>å­˜å‚¨ç»Ÿè®¡</h3>
          <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '10px'}}>
            <div>
              <h4>æ€»ä½“ä¿¡æ¯</h4>
              <p>ç ”ç©¶ç»„æ•°: {storageStats.storage_statistics.total_groups}</p>
              <p>æ–‡ä»¶æ€»æ•°: {storageStats.storage_statistics.total_files}</p>
              <p>æ€»å¤§å°: {(storageStats.storage_statistics.total_size / 1024 / 1024 / 1024).toFixed(2)} GB</p>
            </div>
            <div>
              <h4>æ–‡ä»¶ç±»å‹åˆ†å¸ƒ</h4>
              {Object.entries(storageStats.storage_statistics.file_type_distribution).map(([type, count]) => (
                <p key={type}>{type.toUpperCase()}: {count} ä¸ª</p>
              ))}
            </div>
            <div>
              <h4>å­˜å‚¨å¥åº·</h4>
              <p>ç£ç›˜ä½¿ç”¨ç‡: {storageStats.storage_health.disk_usage}</p>
              <p>å¯ç”¨ç©ºé—´: {storageStats.storage_health.available_space}</p>
              <p>å­¤ç«‹æ–‡ä»¶: {storageStats.storage_health.orphaned_files}</p>
            </div>
          </div>
          <button 
            onClick={handleStorageCleanup}
            disabled={loading}
            style={{marginTop: '10px', backgroundColor: '#ff9800', color: 'white'}}
          >
            æ¸…ç†å­˜å‚¨ç©ºé—´
          </button>
        </div>
      )}

      {/* AIæœåŠ¡ç»Ÿè®¡ */}
      {aiStats && (
        <div style={{background: '#fff', border: '1px solid #ddd', padding: '15px', margin: '10px 0'}}>
          <h3>AIæœåŠ¡ç»Ÿè®¡</h3>
          <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '10px'}}>
            <div>
              <h4>æŸ¥è¯¢ç»Ÿè®¡</h4>
              <p>æ€»æŸ¥è¯¢æ•°: {aiStats.total_queries}</p>
              <p>å¹³å‡å“åº”æ—¶é—´: {aiStats.average_response_time}s</p>
              <p>æˆåŠŸç‡: {(aiStats.success_rate * 100).toFixed(1)}%</p>
            </div>
            <div>
              <h4>çƒ­é—¨é—®é¢˜</h4>
              {aiStats.popular_questions?.map((question, index) => (
                <p key={index}>{index + 1}. {question}</p>
              ))}
            </div>
            <div>
              <h4>æ¯æ—¥ä½¿ç”¨é‡</h4>
              {Object.entries(aiStats.daily_usage || {}).slice(-7).map(([date, count]) => (
                <p key={date}>{date}: {count} æ¬¡</p>
              ))}
            </div>
          </div>
        </div>
      )}

      {loading && <div>å¤„ç†ä¸­...</div>}
    </div>
  );
};
```

## ğŸ”„ æ›´æ–°è¯´æ˜

### æ–°å¢åŠŸèƒ½æ€»ç»“

1. **æ–‡çŒ®é«˜çº§ç®¡ç†**ï¼š
   - è½¯åˆ é™¤å’Œæ¢å¤åŠŸèƒ½
   - å›æ”¶ç«™ç®¡ç†
   - æ–‡çŒ®ç»Ÿè®¡ä¿¡æ¯

2. **å¯¹è¯ç®¡ç†**ï¼š
   - ä¼šè¯å†å²æŸ¥çœ‹
   - å¯¹è¯è®°å½•ç®¡ç†
   - ç”¨æˆ·åé¦ˆç³»ç»Ÿ

3. **ç¼“å­˜ç®¡ç†**ï¼š
   - ç¼“å­˜çŠ¶æ€ç›‘æ§
   - ç¼“å­˜æ¸…ç†å’Œé¢„çƒ­
   - æ€§èƒ½æµ‹è¯•å·¥å…·

4. **ç®¡ç†å‘˜åŠŸèƒ½**ï¼š
   - å­˜å‚¨ç©ºé—´ç®¡ç†
   - AIæœåŠ¡ç›‘æ§
   - ç³»ç»Ÿç»Ÿè®¡ä»ªè¡¨æ¿

### ä½¿ç”¨å»ºè®®

1. **æƒé™æ§åˆ¶**ï¼šç®¡ç†å‘˜åŠŸèƒ½éœ€è¦é€‚å½“çš„æƒé™éªŒè¯
2. **é”™è¯¯å¤„ç†**ï¼šæ‰€æœ‰APIè°ƒç”¨éƒ½åº”åŒ…å«é”™è¯¯å¤„ç†
3. **ç”¨æˆ·ä½“éªŒ**ï¼šé•¿æ—¶é—´æ“ä½œè¦æ˜¾ç¤ºåŠ è½½çŠ¶æ€
4. **æ•°æ®åˆ·æ–°**ï¼šæ“ä½œå®ŒæˆååŠæ—¶åˆ·æ–°ç›¸å…³æ•°æ®

è¿™äº›æ–°åŠŸèƒ½ä¸ºç³»ç»Ÿæä¾›äº†æ›´å®Œæ•´çš„ç®¡ç†èƒ½åŠ›ï¼Œå»ºè®®æ ¹æ®å®é™…éœ€æ±‚é€æ­¥å®ç°å’Œéƒ¨ç½²ã€‚

## âš ï¸ å¸¸è§é—®é¢˜

### 1. CORSé—®é¢˜
å¦‚æœé‡åˆ°è·¨åŸŸé—®é¢˜ï¼Œç¡®ä¿åç«¯å·²æ­£ç¡®é…ç½®CORSï¼š

```javascript
// å¦‚æœéœ€è¦ï¼Œå¯ä»¥åœ¨å¼€å‘ç¯å¢ƒä½¿ç”¨ä»£ç†
// package.json (for Create React App)
{
  "proxy": "http://localhost:8000"
}

// æˆ–è€…åœ¨vite.config.jsä¸­é…ç½®
export default defineConfig({
  server: {
    proxy: {
      '/api': 'http://localhost:8000',
      '/health': 'http://localhost:8000',
      '/literature': 'http://localhost:8000'
    }
  }
});
```

### 2. æ–‡ä»¶é¢„è§ˆé—®é¢˜

```javascript
// PDFé¢„è§ˆç»„ä»¶ç¤ºä¾‹
import { Document, Page, pdfjs } from 'react-pdf';

// è®¾ç½®PDF.js worker
pdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.min.js`;

const PDFViewer = ({ literatureId }) => {
  const [file, setFile] = useState(null);
  const [numPages, setNumPages] = useState(null);
  const [pageNumber, setPageNumber] = useState(1);

  useEffect(() => {
    // è·å–PDFæ–‡ä»¶
    const fileURL = LiteratureAPI.getFileURL(literatureId);
    setFile({
      url: fileURL,
      httpHeaders: {
        'Authorization': `Bearer ${api.token}`
      }
    });
  }, [literatureId]);

  const onDocumentLoadSuccess = ({ numPages }) => {
    setNumPages(numPages);
  };

  return (
    <div>
      <Document
        file={file}
        onLoadSuccess={onDocumentLoadSuccess}
      >
        <Page pageNumber={pageNumber} />
      </Document>
      
      <div>
        <button 
          disabled={pageNumber <= 1}
          onClick={() => setPageNumber(pageNumber - 1)}
        >
          ä¸Šä¸€é¡µ
        </button>
        
        <span>ç¬¬ {pageNumber} é¡µï¼Œå…± {numPages} é¡µ</span>
        
        <button 
          disabled={pageNumber >= numPages}
          onClick={() => setPageNumber(pageNumber + 1)}
        >
          ä¸‹ä¸€é¡µ
        </button>
      </div>
    </div>
  );
};
```

### 3. ç§»åŠ¨ç«¯é€‚é…

```css
/* å“åº”å¼è®¾è®¡ç¤ºä¾‹ */
.upload-form {
  padding: 20px;
}

@media (max-width: 768px) {
  .upload-form {
    padding: 10px;
  }
  
  .literature-grid {
    display: block;
  }
  
  .literature-item {
    margin-bottom: 10px;
  }
}

/* AIèŠå¤©ç•Œé¢ç§»åŠ¨ç«¯ä¼˜åŒ– */
.ai-chat {
  height: calc(100vh - 200px);
}

@media (max-width: 768px) {
  .ai-chat {
    height: calc(100vh - 150px);
  }
  
  .preset-questions button {
    font-size: 14px;
    padding: 8px;
  }
}
```

## ğŸ“± ç§»åŠ¨ç«¯æ³¨æ„äº‹é¡¹

1. **æ–‡ä»¶ä¸Šä¼ **: ç§»åŠ¨ç«¯æ–‡ä»¶é€‰æ‹©å¯èƒ½æœ‰é™åˆ¶ï¼Œå»ºè®®æä¾›æ˜ç¡®çš„æ–‡ä»¶ç±»å‹è¯´æ˜
2. **PDFæŸ¥çœ‹**: è€ƒè™‘ä½¿ç”¨æµè§ˆå™¨å†…ç½®PDFæŸ¥çœ‹å™¨æˆ–ç¬¬ä¸‰æ–¹åº“
3. **AIèŠå¤©**: åœ¨å°å±å¹•ä¸Šä¼˜åŒ–èŠå¤©ç•Œé¢å¸ƒå±€
4. **ç½‘ç»œçŠ¶æ€**: è€ƒè™‘ç½‘ç»œä¸ä½³æ—¶çš„é‡è¯•æœºåˆ¶

## ğŸš€ éƒ¨ç½²å»ºè®®

### ç¯å¢ƒå˜é‡é…ç½®

```javascript
// ç¯å¢ƒé…ç½®
const config = {
  development: {
    API_BASE_URL: 'http://localhost:8000'
  },
  production: {
    API_BASE_URL: 'https://your-api-domain.com'
  }
};

export const API_BASE_URL = config[process.env.NODE_ENV] || config.development;
```

### ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–

1. **APIè¯·æ±‚ä¼˜åŒ–**: ä½¿ç”¨é˜²æŠ–å’ŒèŠ‚æµ
2. **å›¾ç‰‡æ‡’åŠ è½½**: å¯¹äºæ–‡çŒ®å°é¢ç­‰
3. **ä»£ç åˆ†å‰²**: æŒ‰è·¯ç”±åˆ†å‰²ä»£ç 
4. **ç¼“å­˜ç­–ç•¥**: åˆç†ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜

è¿™ä»½å¼€å‘æŒ‡å—åº”è¯¥èƒ½å¸®åŠ©å‰ç«¯å›¢é˜Ÿå¿«é€Ÿä¸Šæ‰‹APIçš„ä½¿ç”¨ã€‚å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·éšæ—¶è”ç³»åç«¯å¼€å‘å›¢é˜Ÿï¼ 